# How to prevent file upload vulnerabilities

Разрешение пользователям загружать файлы является обычным явлением и не должно быть опасным, если вы принимаете правильные меры предосторожности. В общем, самый эффективный способ защитить свои собственные веб-сайты от этих уязвимостей — это реализовать все следующие методы:

* Проверьте расширение файла по белому списку разрешенных расширений, а не по черному списку запрещенных. Гораздо проще угадать, какие расширения вы хотите разрешить, чем угадать, какие из них может попытаться загрузить злоумышленник.

* Убедитесь, что имя файла не содержит подстрок, которые могут быть интерпретированы как каталог или последовательность обхода (../)

* Переименовывайте загруженные файлы, чтобы избежать конфликтов, которые могут привести к перезаписи существующих файлов.

* Не загружайте файлы в постоянную файловую систему сервера, пока они не будут полностью проверены.

* Насколько это возможно, используйте устоявшуюся структуру для предварительной обработки загружаемых файлов, а не пытайтесь писать собственные механизмы проверки.
