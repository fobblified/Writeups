# How to prevent SSRF attacks

<h3>Белый список доменов в DNS</h3>

Самый простой способ исправить SSRF — внести в белый список любой домен или адрес, к которым обращается ваше приложение.

У черных списков и регулярных выражений одна и та же проблема, кто-то в конечном итоге найдет способ их использовать.

<h3>Не отправляйте необработанные ответы</h3>

Никогда не отправляйте необработанное тело ответа с сервера клиенту. Ответы, которые получает клиент, должны быть ожидаемыми.

<h3>Применение схем URL</h3>

Разрешите только те схемы URL, которые использует ваше приложение. Нет необходимости включать ftp://, file:/// или даже http://, если вы используете только https://.

И если вы используете другие схемы, убедитесь, что они доступны только из той части, которая должна получить к ним доступ, а не откуда-либо еще.

<h3>Включить аутентификацию во всех службах</h3>

Убедитесь, что проверка подлинности включена для любой службы, работающей в вашей сети, даже если она не требуется. Такие сервисы, как memcached, redis, mongo и другие, не требуют аутентификации для нормальной работы, но это означает, что их можно использовать.

<h3>Дезинфекция и проверка входных данных</h3>

Никогда не доверяйте пользовательскому вводу.

Всегда очищайте любой ввод, который пользователь отправляет в ваше приложение. Удалите неверные символы, стандартизируйте ввод (например, двойные кавычки вместо одинарных).

После дезинфекции обязательно проверьте санированный ввод, чтобы убедиться, что ничего плохого не прошло.
