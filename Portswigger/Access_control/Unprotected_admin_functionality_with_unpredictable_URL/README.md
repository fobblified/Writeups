# Unprotected admin functionality with unpredictable URL

## Theory

<h3>Незащищенная функциональность</h3>

В основном, вертикальное повышение привилегий возникает, когда приложение не обеспечивает никакой защиты конфиденциальной функциональности. Например, административные функции могут быть связаны со страницей приветствия администратора, но не со страницы приветствия пользователя. Однако пользователь может просто получить доступ к административным функциям, перейдя непосредственно по соответствующему URL-адресу администратора.

Например, на веб-сайте могут размещаться конфиденциальные функции по следующему URL-адресу:
```
https://insecure-website.com/admin
```

На самом деле это может быть доступно любому пользователю, а не только администраторам, у которых есть ссылка на эту функцию в их пользовательском интерфейсе. В некоторых случаях административный URL-адрес может быть раскрыт в других местах, например в файле robots.txt:
```
https://insecure-website.com/robots.txt
```

Даже если URL-адрес нигде не раскрывается, злоумышленник может использовать список слов для подбора местоположения конфиденциальных функций.

В некоторых случаях конфиденциальная функциональность не защищена надежно, а скрыта за счет предоставления менее предсказуемого URL-адреса: так называемая безопасность через неясность. Простое сокрытие конфиденциальных функций не обеспечивает эффективного контроля доступа, поскольку пользователи все равно могут обнаружить запутанный URL-адрес различными способами.

Например, рассмотрим приложение, в котором размещены административные функции по следующему URL-адресу:
```
https://insecure-website.com/administrator-panel-yb556
```

Злоумышленник может не сразу догадаться об этом. Однако приложение может по-прежнему передавать URL-адрес пользователям. Например, URL-адрес может быть раскрыт в JavaScript, который создает пользовательский интерфейс на основе роли пользователя:
```
<script>
var isAdmin = false;
if (isAdmin) {
	...
	var adminPanelTag = document.createElement('a');
	adminPanelTag.setAttribute('https://insecure-website.com/administrator-panel-yb556');
	adminPanelTag.innerText = 'Admin panel';
	...
}
</script>
```

Этот сценарий добавляет ссылку в пользовательский интерфейс пользователя, если он является пользователем-администратором. Однако сценарий, содержащий URL-адрес, виден всем пользователям независимо от их роли.

## Writeup

Главная страница:

![](https://github.com/fobblified/Writeups/blob/main/Portswigger/Access_control/Unprotected_admin_functionality_with_unpredictable_URL/assets/1.png)

В коде страницы мы можем обнаружить скрипт, который проверяет пользователя на наличие прав администратора. Если таковые права имеются, пользователь получает кнопку, которая переадресует его к панели администратора.

![](https://github.com/fobblified/Writeups/blob/main/Portswigger/Access_control/Unprotected_admin_functionality_with_unpredictable_URL/assets/2.png)

Перейдем на страницу /admin-msrqu6.

![](https://github.com/fobblified/Writeups/blob/main/Portswigger/Access_control/Unprotected_admin_functionality_with_unpredictable_URL/assets/3.png)

Удаляем пользователя carlos и получаем ответ от сервера.

![](https://github.com/fobblified/Writeups/blob/main/Portswigger/Access_control/Unprotected_admin_functionality_with_unpredictable_URL/assets/4.png)
