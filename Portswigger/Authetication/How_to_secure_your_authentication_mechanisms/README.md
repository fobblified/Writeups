# How to secure your authentication mechanisms

<h3>Будьте осторожны с учетными данными пользователя</h3>

Даже самые надежные механизмы аутентификации неэффективны, если вы непреднамеренно раскрываете злоумышленнику действительный набор учетных данных для входа. Само собой разумеется, что вы никогда не должны отправлять данные для входа в систему по незашифрованным соединениям. Хотя вы, возможно, внедрили HTTPS для своих запросов на вход, убедитесь, что вы применяете это, перенаправляя любые попытки HTTP-запросов на HTTPS.

<h3>Не рассчитывайте на пользователей в плане безопасности</h3>

Меры строгой аутентификации часто требуют дополнительных усилий со стороны ваших пользователей. Человеческая природа делает почти неизбежным то, что некоторые пользователи найдут способы избавить себя от этих усилий. Поэтому вам необходимо обеспечить безопасное поведение везде, где это возможно.

Самый очевидный пример — реализация эффективной политики паролей. Некоторые из более традиционных политик терпят неудачу, потому что люди встраивают в политику свои предсказуемые пароли. Вместо этого может быть более эффективным реализовать какое-либо простое средство проверки паролей, которое позволяет пользователям экспериментировать с паролями и предоставляет обратную связь об их надежности в режиме реального времени. Популярным примером является библиотека JavaScript zxcvbn, разработанная Dropbox. Разрешая использовать только те пароли, которые высоко оцениваются средством проверки паролей, вы можете обеспечить использование безопасных паролей более эффективно, чем с помощью традиционных политик.

<h3>Запретить перечисление имени пользователя</h3>

Злоумышленнику значительно легче взломать ваши механизмы аутентификации, если вы обнаружите, что в системе существует пользователь. Есть даже определенные ситуации, когда из-за характера веб-сайта информация о том, что у конкретного человека есть учетная запись, сама по себе является конфиденциальной информацией.

Независимо от того, является ли имя пользователя допустимым, важно использовать идентичные общие сообщения об ошибках и убедиться, что они действительно идентичны. Вы всегда должны возвращать один и тот же код состояния HTTP с каждым запросом на вход и, наконец, сделать время отклика в разных сценариях как можно более неразличимым.

<h3>Реализовать надежную защиту от грубой силы</h3>

Учитывая, насколько простым может быть построение атаки грубой силы, жизненно важно убедиться, что вы предпринимаете шаги для предотвращения или, по крайней мере, пресечения любых попыток входа в систему методом грубой силы.

Одним из наиболее эффективных методов является реализация строгого ограничения скорости пользователей на основе IP-адресов. Это должно включать меры по предотвращению манипулирования злоумышленниками их видимого IP-адреса. В идеале вы должны требовать от пользователя выполнения теста CAPTCHA при каждой попытке входа в систему после достижения определенного предела.

Имейте в виду, что это не гарантирует полного устранения угрозы грубой силы. Однако максимально утомительный и ручной процесс увеличивает вероятность того, что любой потенциальный злоумышленник сдастся и вместо этого отправится на поиски более слабой цели.

<h3>Трижды проверьте логику проверки</h3>

Простые логические ошибки легко проникают в код, что в случае аутентификации может полностью скомпрометировать ваш веб-сайт и пользователей. Тщательный аудит любой логики проверки или валидации для устранения недостатков является абсолютным ключом к надежной аутентификации. Проверка, которую можно обойти, в конечном счете, ненамного лучше, чем отсутствие проверки вообще.

<h3>Трижды проверьте логику проверки</h3>

Не сосредотачивайтесь только на центральных страницах входа и упускайте из виду дополнительные функции, связанные с аутентификацией. Это особенно важно в тех случаях, когда злоумышленник может зарегистрировать собственную учетную запись и изучить эту функциональность. Помните, что сброс или изменение пароля является такой же допустимой поверхностью атаки, как и основной механизм входа в систему, и, следовательно, должен быть столь же надежным.

<h3>Внедрите правильную многофакторную аутентификацию</h3>

Наконец, как и в случае с основной логикой аутентификации, убедитесь, что логика в ваших проверках 2FA надежна, чтобы ее нельзя было легко обойти. Хотя многофакторная аутентификация может быть непрактичной для каждого веб-сайта, при правильном выполнении она намного безопаснее, чем вход только на основе пароля. Помните, что проверка нескольких экземпляров одного и того же фактора не является настоящей многофакторной аутентификацией. Отправка кодов подтверждения по электронной почте — это, по сути, более многословная форма однофакторной аутентификации.

Двухфакторная аутентификация на основе SMS технически проверяет два фактора: что-то, что вы знаете, и что-то, что у вас есть. Однако возможность злоупотреблений, например, посредством замены SIM-карты, означает, что эта система может быть ненадежной.

В идеале двухфакторная аутентификация должна быть реализована с использованием специального устройства или приложения, которое напрямую генерирует код подтверждения. Поскольку они специально созданы для обеспечения безопасности, они обычно более безопасны.

Наконец, как и в случае с основной логикой аутентификации, убедитесь, что логика в ваших проверках 2FA надежна, чтобы ее нельзя было легко обойти.
