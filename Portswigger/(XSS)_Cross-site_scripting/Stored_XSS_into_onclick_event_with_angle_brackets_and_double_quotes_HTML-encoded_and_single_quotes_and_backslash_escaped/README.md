# Stored XSS into onclick event with angle brackets and double quotes HTML-encoded and single quotes and backslash escaped

## Theory

<h3>Использование HTML-кодирования</h3>

Когда контекст XSS представляет собой некоторый существующий код JavaScript в атрибуте тега в кавычках, например обработчик событий, можно использовать HTML-кодирование для обхода некоторых входных фильтров.

Когда браузер проанализировал HTML-теги и атрибуты в ответе, он выполнит HTML-декодирование значений атрибутов тегов, прежде чем они будут обработаны дальше. Если приложение на стороне сервера блокирует или очищает определенные символы, необходимые для успешного использования XSS-эксплойта, вы часто можете обойти проверку ввода, закодировав эти символы в HTML.

Например, если контекст XSS выглядит следующим образом:
```
<a href="#" onclick="... var input='controllable data here'; ...">
```

и приложение блокирует или экранирует одинарные кавычки, вы можете использовать следующую полезную нагрузку, чтобы выйти из строки JavaScript и выполнить свой собственный скрипт:
```
&apos;-alert(document.domain)-&apos;
```

Последовательность ' представляет собой объект HTML, представляющий апостроф или одинарную кавычку. Поскольку браузер HTML-декодирует значение атрибута onclick перед интерпретацией JavaScript, объекты декодируются как кавычки, которые становятся разделителями строк, и поэтому атака завершается успешно.

## Writeup

[1]: ./assets/1.png
[2]: ./assets/2.png
[3]: ./assets/3.png
[4]: ./assets/4.png

Главная страница:

![][1]

Перейдем к любому посту. Спустимся в низ страницы. У нас есть поле для комментария.

![][2]

Вставим наш экплоит в поле Website и отправим запрос. Код экплоита:
```
http://foo?&apos;-alert(1)-&apos;
```

![][3]

Получаем ответ от сервера.

![][4]